## Codebase Patterns
- Backend uses SQLAlchemy 2.0+ async with `Mapped` type hints and `mapped_column`
- All models use `UUID(as_uuid=True)` primary keys with `default=uuid.uuid4`
- Timestamps: `DateTime(timezone=True)` with `server_default=func.now()` and `onupdate=func.now()` for `updated_at`
- Foreign keys use `ondelete="CASCADE"` pattern with `index=True`
- Relationships use `back_populates` (bidirectional) with `cascade="all, delete-orphan"` on parent side
- Alembic migrations use `postgresql.UUID(as_uuid=True)` in migration files (not just `sa.UUID`)
- Tests run via `.venv/bin/pytest tests/ -x -q` from backend directory
- Ruff linter at `.venv/bin/ruff`, line length 100
- No mypy installed; typecheck is implied via ruff + Python import verification
---

# Ralph Progress Log
Started: Sat Feb 21 10:55:30 EST 2026
---

## 2026-02-21 - US-001
- What was implemented: Created three SQLAlchemy models (`Sequence`, `SequenceMeasure`, `SequenceBeat`) in `backend/models/sequence.py`. Added `sequence` back-reference to `Song` model. Created Alembic migration `c3f2a1b4d5e6_add_sequence_tables.py`.
- Files changed:
  - `backend/models/sequence.py` (new)
  - `backend/models/__init__.py` (added Sequence, SequenceMeasure, SequenceBeat exports)
  - `backend/models/song.py` (added `sequence` relationship with `uselist=False`)
  - `backend/alembic/versions/c3f2a1b4d5e6_add_sequence_tables.py` (new)
- **Learnings for future iterations:**
  - The venv is at `backend/.venv/` — use `.venv/bin/pytest`, `.venv/bin/ruff`, `.venv/bin/alembic`
  - Migration files must use `postgresql.UUID(as_uuid=True)` from `sqlalchemy.dialects`, not just `sa.UUID`
  - `sequence_beat.chord_id` uses `ondelete="SET NULL"` (not CASCADE) since removing a chord shouldn't destroy beat slots
  - `UniqueConstraint` in `__table_args__` must be a tuple — trailing comma required for single-element tuple
  - Ruff line length is 100; watch for long `__table_args__` lines
---
