# Ralph Progress Log
Started: Mon Feb 16 10:26:56 EST 2026
---

## Codebase Patterns
- Backend uses SQLAlchemy 2.0+ with `Mapped` and `mapped_column` style
- Pydantic schemas: `Create` has defaults, `Update` has all optional fields, `Response` has `from_attributes`
- Alembic migrations use `collections.abc.Sequence`, import style: `from alembic import op`
- Router manually maps schema fields to model constructor (no `**data.model_dump()`)
- Virtual env at `backend/.venv`; run tools with `.venv/bin/python`, `.venv/bin/ruff`, `.venv/bin/pytest`
- Ruff config in pyproject.toml: line-length 100, selects E/F/I/N/W/UP
- All 79 tests are async with `asyncio_mode = "auto"`

---

## 2026-02-16 - US-001
- What was implemented: Added `starting_fret` integer field (default 0) to the Chord model, Pydantic schemas (ChordCreate, ChordUpdate, ChordResponse), and API router (create + update endpoints)
- Created Alembic migration `851f7f6990f1` with `server_default='0'` so existing rows get the default
- Files changed:
  - `backend/models/chord.py` - Added `starting_fret` mapped column
  - `backend/schemas/chord.py` - Added `starting_fret` to all three schemas
  - `backend/routers/chords.py` - Wired `starting_fret` into create and update handlers
  - `backend/alembic/versions/851f7f6990f1_add_starting_fret_to_chords.py` - New migration
- **Learnings for future iterations:**
  - Alembic autogenerate template doesn't match project lint rules; needs manual cleanup (imports, string style, line length)
  - Router maps fields explicitly â€” when adding a new model field, must update both create_chord and update_chord in the router
  - Migration needs `server_default` for NOT NULL columns to handle existing rows
---
